import { _ao_pipe_out_base } from './pipe_base.jsy'
import { fn_chain } from './util.jsy'
import { ao_split, ao_tap } from './split.jsy'
import { ao_run } from './drive.jsy'

export const _ao_pipe_out = @{}
  ... _ao_pipe_out_base

  chain(fn) :: return fn_chain(this, this)(fn)

  split(xfn) :: return ao_split(this, xfn)
  tap(xfn) :: return ao_tap(this, xfn)
  run(xfn) ::
    let p = ao_run(this)
    return xfn ? xfn(p) : p

